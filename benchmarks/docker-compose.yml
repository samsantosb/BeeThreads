version: '3.8'

services:
  # Node.js Benchmark
  bench-node:
    build:
      context: ..
      dockerfile: benchmarks/Dockerfile.node
    container_name: bee-threads-bench-node
    volumes:
      - ./results:/app/benchmarks/results
    # Allocate resources for accurate benchmarks
    deploy:
      resources:
        limits:
          cpus: '8'
          memory: 8G
    # Enable SharedArrayBuffer
    ipc: host

  # Bun Benchmark
  bench-bun:
    build:
      context: ..
      dockerfile: benchmarks/Dockerfile.bun
    container_name: bee-threads-bench-bun
    volumes:
      - ./results:/app/benchmarks/results
    deploy:
      resources:
        limits:
          cpus: '8'
          memory: 8G
    ipc: host

